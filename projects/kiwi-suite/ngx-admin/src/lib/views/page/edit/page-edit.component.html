<kiwi-content>
  <ng-template #headerButtons>
    <ng-container *ngIf="data$ | async as data">
      <button class="btn btn-primary" (click)="onSubmit()">
        <i class="fa fa-save"></i> Update
      </button>
      <button class="btn btn-danger" (click)="doDelete()">
        <i class="fa fa-trash"></i>
      </button>
    </ng-container>

  </ng-template>

  <ng-container *ngIf="versionData$ | async as versionData; else isLoading">
    <ng-container *ngIf="versionForm && versionFields">
      <formly-form [form]="versionForm" [fields]="versionFields" [model]="versionData.content"
                   class="kiwi-form kiwi-form-inline"></formly-form>
    </ng-container>
  </ng-container>
  <ng-template #isLoading>
    <div class="text-center my-3 loading">
      <kiwi-loading class="big-center"></kiwi-loading>
    </div>
  </ng-template>

  <ng-template #aside>
    <tabset>
      <tab>
        <ng-template tabHeading>
          <i class="fa fa-cog"></i>
        </ng-template>
        <div class="p-3">

          <ng-container *ngIf="data$ | async as data">
            <a class="btn btn-primary btn-block mb-3" [href]="data.page.url" target="_blank">
              <i class="fa fa-eye"></i> Open Page
            </a>
          </ng-container>

          <div class="kiwi-form" *ngIf="pageData">
            <h6><i class="fa fa-fw fa-cog"></i> General</h6>

            <div class="form-group">
              <label class="kiwi-form-label">
                Name<b class="text-danger">*</b>
              </label>

              <div class="kiwi-form-control-container">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Name" [(ngModel)]="pageData.name">
                  <div class="input-group-append">
                    <button type="button" class="btn btn-outline-primary" (click)="savePageData('name', pageData.name)">
                      <i class="fa fa-save"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label class="kiwi-form-label">
                Slug<b class="text-danger">*</b>
              </label>

              <div class="kiwi-form-control-container">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Slug" [(ngModel)]="pageData.slug">
                  <div class="input-group-append">
                    <button type="button" class="btn btn-outline-primary" (click)="savePageData('slug', pageData.slug)">
                      <i class="fa fa-save"></i>
                    </button>
                  </div>
                </div>
                <small class="form-text text-muted">The slug is used to create the Website URL</small>
              </div>
            </div>

            <div class="form-group kiwi-toggle-right">
              <label class="kiwi-form-label">
                Online<b class="text-danger">*</b>
              </label>

              <div class="kiwi-form-control-container">
                <label class="switch switch-primary">
                  <input type="checkbox" class="switch-input" [(ngModel)]="pageData.online" (change)="savePageData('status', pageData.online ? 'online' : 'offline')">
                  <span class="switch-slider"></span>
                </label>
              </div>
            </div>

            <hr/>

            <h6><i class="fa fa-fw fa-calendar"></i> Scheduling</h6>

            <div class="form-group">
              <label class="kiwi-form-label">
                Published From<b class="text-danger">*</b>
              </label>
              <div class="kiwi-form-control-container">
                <div class="input-group">
                  <kiwi-date-picker placeholder="Published From" [(ngModel)]="pageData.publishedFrom"></kiwi-date-picker>
                  <div class="input-group-append">
                    <button type="button" class="btn btn-outline-primary" (click)="savePageData('publishedFrom', pageData.publishedFrom)">
                      <i class="fa fa-save"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label class="kiwi-form-label">
                Published Until<b class="text-danger">*</b>
              </label>
              <div class="kiwi-form-control-container">
                <div class="input-group">
                  <kiwi-date-picker placeholder="Published Until" [(ngModel)]="pageData.publishedUntil"></kiwi-date-picker>
                  <div class="input-group-append">
                    <button type="button" class="btn btn-outline-primary" (click)="savePageData('publishedUntil', pageData.publishedUntil)">
                      <i class="fa fa-save"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <hr/>

            <h6><i class="fa fa-fw fa-compass"></i> Navigation</h6>

            <div class="form-group">
              <div class="input-group">
                <ng-select
                  [(ngModel)]="selectedNavigationOptions"
                  [items]="navigationOptions"
                  placeholder="Navigation"
                  bindValue="name"
                  bindLabel="label"
                  [multiple]="true">
                </ng-select>
                <div class="input-group-append">
                  <button type="button" class="btn btn-outline-primary" (click)="savePageData('navigation', selectedNavigationOptions)">
                    <i class="fa fa-save"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </tab>
      <tab>
        <ng-template tabHeading>
          <i class="fa fa-wrench"></i>
        </ng-template>
        <div class="p-3">
          <!--
          <ng-container *ngIf="detailData$ | async as detailData">
            <ng-container *ngIf="detailData.meta.otherLanguages.length > 0">
              <h6><i class="fa fa-fw fa-clone"></i> Replace Content</h6>
              <ng-container *ngIf="detailData.meta.otherLanguages.length > 0">
                <div>
                  <small><b>From other language</b></small>
                </div>
                <div class="row mb-3">
                  <div class="col" *ngFor="let language of detailData.meta.otherLanguages">
                    <a style="cursor: pointer;" (click)="onReplaceContentModal(language)">
                      <i class="flag-icon flag-icon-{{ language.locale.substr(3) | lowercase }}"></i>
                    </a>
                  </div>
                </div>
              </ng-container>
              <ng-container *ngIf="detailData.meta.samePageTypePages.length > 0">
                <div>
                  <small><b>From other page</b></small>
                </div>
                <ng-select [items]="detailData.meta.samePageTypePages" (change)="onReplaceContentModal($event)"
                           bindLabel="name" bindValue="id" [clearable]="false">
                </ng-select>
              </ng-container>
              <hr>
            </ng-container>
          </ng-container>
          -->
        </div>
      </tab>
    </tabset>
  </ng-template>

</kiwi-content>
