<div *ngIf="(schema$ | async) && (action$ | async) as action">
    <div *ngIf="action === 'create'">
        <div class="row">
            <div class="col-lg-8 col-xl-6">
                <form [formGroup]="form" (ngSubmit)="onSubmit(action)" *ngIf="form" novalidate>
                    <div class="card card-accent-primary">
                        <div class="card-header">
                            <b class="text-muted">{{ resourceName$ | async }}</b>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <input formControlName="email" type="email" class="form-control"
                                       autocomplete="email"
                                       placeholder="Email address">
                            </div>
                            <div class="form-group">
                                <ng-select [searchable]="false" formControlName="role">
                                    <ng-option value="admin">Admin</ng-option>
                                    <ng-option value="editor">Editor</ng-option>
                                    <ng-option value="user">User</ng-option>
                                </ng-select>
                            </div>

                            <div class="form-group">
                                <input formControlName="password" type="password" class="form-control"
                                       autocomplete="password"
                                       placeholder="Password">
                            </div>

                            <div class="form-group">
                                <input formControlName="passwordRepeat" type="password" class="form-control"
                                       autocomplete="password"
                                       placeholder="Repeat password">
                            </div>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-primary"
                                    [disabled]="(dirty$ | async) && (loading$ | async)">
                                <i class="fa fa-save"></i>
                                Create
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div *ngIf="action === 'edit' && (model$ | async)">
        <div class="row">
            <div class="col-lg-4 col-xl-6 order-lg-2">
                <div class="card card-accent-primary">
                    <div class="card-header">
                        <b class="text-muted">{{ resourceName$ | async }}</b>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <img class="mb-2" style="width:50px;height:50px;" *ngIf="model.avatar"
                                     [src]="sanitizeUrl('data:image/svg+xml;utf8,' + model.avatar )" [alt]="model.id">
                            </div>
                            <div class="col-md-9">
                                <dl class="row mb-0">
                                    <dt class="col-md-4" *ngIf="model.createdAt">
                                        Created
                                    </dt>
                                    <dd class="col-md-8" *ngIf="model.createdAt">
                                        {{ model.createdAt | date:'MMMM d, y, h:mm:ss' }}
                                    </dd>
                                    <dt class="col-md-4" *ngIf="model.lastLoginAt">
                                        Last login
                                    </dt>
                                    <dd class="col-md-8" *ngIf="model.lastLoginAt">
                                        {{ model.lastLoginAt | date:'MMMM d,y, h:mm:ss' }}
                                    </dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer" *ngIf="model.id !== account.id">
                        <button type="button" class="btn btn-outline-danger pull-right"
                                [disabled]="(loading$ | async)"
                                (click)="onDelete()"
                                *can="['admin.api.'+resourceKey+'.delete']">
                            <i class="fa fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 col-xl-6 order-lg-1">
                <form [formGroup]="emailForm" (ngSubmit)="onSubmitEmail()" *ngIf="emailForm" novalidate>
                    <div class="card card-accent-primary">
                        <div class="card-header">
                            <b class="text-muted">Email</b>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="{{ model.email }}" readonly>
                            </div>
                            <div class="form-group">
                                <input formControlName="email" type="email" class="form-control"
                                       autocomplete="new-email"
                                       placeholder="New email address">
                            </div>
                            <div class="form-group">
                                <input formControlName="emailRepeat" type="email" class="form-control"
                                       autocomplete="new-email"
                                       placeholder="Confirm new email address">
                            </div>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-primary"
                                    [disabled]="(dirty$ | async) && (loading$ | async)">
                                <i class="fa fa-save"></i>
                                Update
                            </button>
                        </div>
                    </div>
                </form>
                <form [formGroup]="updateForm" (ngSubmit)="onSubmitUpdate()" *ngIf="updateForm" novalidate>
                    <div class="card card-accent-primary">
                        <div class="card-header">
                            <b class="text-muted">Properties</b>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <ng-select [searchable]="false" formControlName="role">
                                    <ng-option value="admin">Admin</ng-option>
                                    <ng-option value="editor">Editor</ng-option>
                                    <ng-option value="user">User</ng-option>
                                </ng-select>
                            </div>

                            <div class="form-group">
                                <ng-select [searchable]="false" formControlName="status">
                                    <ng-option value="active">Active</ng-option>
                                    <ng-option value="inactive">Inactive</ng-option>
                                </ng-select>
                            </div>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-primary"
                                    [disabled]="(dirty$ | async) && (loading$ | async)">
                                <i class="fa fa-save"></i>
                                Update
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

</div>


